# AI自動日報生成ツール (Auto Daily Report)

Macの画面を定期的にキャプチャして文字認識(OCR)を行い、作業ログを記録するツールです。Googleカレンダーの予定と合わせて、AI（Google Gemini）に日報を自動生成・投稿させることができます。

## 特徴
- **自動記録**: 1分ごとに画面のテキストとアクティブなアプリ名を記録。
- **プライバシー重視**: スクリーンショット画像は保存せず、テキスト情報のみをローカルに保存します。
- **Googleカレンダー連携**: 今日の予定を取得し、作業ログとの乖離を確認できます。
- **完全自動化**: 蓄積したログからプロンプトを生成し、ブラウザ（Gemini）を自動操作して日報を作成・保存します。

## 必要要件
- macOS (Vision Frameworkを使用するため)
- Python 3.9以上
- Google Cloud Project (Calendar API用)
- Google Gemini アカウント

## セットアップ手順

### 1. 必要なライブラリのインストール

ターミナルで以下のコマンドを実行し、依存ライブラリをインストールしてください。

```bash
pip install -r requirements.txt
playwright install chromium
```

### 2. GoogleカレンダーAPIの設定

Googleカレンダーの予定を取得するために、以下の設定が必要です。

1. [Google Cloud Console](https://console.cloud.google.com/) で新しいプロジェクトを作成します。
2. 「**API とサービス**」 > 「**ライブラリ**」から **Google Calendar API** を検索し、有効化します。
3. 「**API とサービス**」 > 「**認証情報**」で **OAuth クライアント ID** を作成します（アプリケーションの種類は **デスクトップ アプリ**）。
4. クライアントIDを作成したら、JSON形式の認証情報をダウンロードし、ファイル名を `credentials.json` に変更して、このプロジェクトのルートディレクトリに配置してください。

> **注意**: 初回実行時にブラウザが立ち上がり、Googleアカウントへのアクセス許可が求められます。

### 3. Macの権限設定

このツールは画面の内容を読み取るため、以下の権限が必要です。

- **画面収録 (Screen Recording)**: ターミナル（または実行するIDE）に許可を与えてください。
  - 「システム設定」 > 「プライバシーとセキュリティ」 > 「画面収録」
- **アクセシビリティ (Accessibility)**: 必要に応じて許可してください。

## 使い方

### 記録の開始 (常駐プロセス)

朝、業務を開始する際に以下のコマンドでログ記録を開始します。終了は `Ctrl+C` です。

```bash
python main.py
```

実行中は `logs/` ディレクトリに `daily_log_YYYY-MM-DD.jsonl` が生成され、1分ごとに追記されます。

### 日報の生成 (業務終了時)

1日の終わりに以下のコマンドを実行します。

```bash
python daily_report.py
```

1. 今日のログとカレンダー予定からプロンプトが生成されます。
2. 「Geminiに自動送信しますか？」と聞かれるので `y` を入力します。
3. ブラウザが自動起動し、Geminiにプロンプトが送信されます。
   * **(初回のみ)** ログインが必要です。画面に従ってログインしてください。次回以降は自動ログインされます。
4. 回答が生成されると自動的に保存され、`outputs/daily_report_YYYY-MM-DD.md` として出力されます。

## ファイル構成

- `main.py`: ログ記録用スクリプト
- `daily_report.py`: 日報生成・自動化スクリプト
- `src/`: 
    - `gemini_automator.py`: ブラウザ自動操作 (Playwright)
    - `ocr_utils.py`: 画面OCR処理
    - `app_utils.py`: アプリ名取得
    - `calendar_utils.py`: カレンダー連携
- `templates/`: プロンプトテンプレート
- `outputs/`: 生成された日報の保存先
- `logs/`: 作業ログ保存先
- `browser_data/`: ブラウザプロファイル（Git管理外）
